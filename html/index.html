<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>WikiOracle</title>
<link rel="stylesheet" href="wikioracle.css">
</head>
<body>

<!-- Header -->
<div class="header">
  <h1><a href="https://WikiOracle.org" target="_blank" class="header-link">WikiOracle</a></h1>
  <button class="header-btn" id="btnImport" title="Open an llm_*.jsonl state file">Open</button>
  <button class="header-btn" id="btnRead" title="Open conversations in a readable view">Read</button>
  <button class="header-btn" id="btnExport" title="Save session as llm_*.jsonl">Save</button>
  <button class="header-btn" id="btnSettings" title="Settings">Settings</button>
</div>

<!-- Settings overlay -->
<div class="settings-overlay" id="settingsOverlay">
  <div class="settings-panel">
    <h2>Settings</h2>

    <label for="setUsername">Your name</label>
    <input type="text" id="setUsername" placeholder="Alec">

    <label for="setProvider">Provider</label>
    <select id="setProvider">
      <option value="wikioracle">WikiOracle NanoChat</option>
      <option value="openai">OpenAI</option>
      <option value="anthropic">Anthropic</option>
    </select>

    <label for="setLayout">Layout</label>
    <select id="setLayout">
      <option value="horizontal">Horizontal (tree on top)</option>
      <option value="vertical">Vertical (tree on left)</option>
    </select>

    <label for="setTheme">Theme</label>
    <select id="setTheme">
      <option value="system">System</option>
      <option value="light">Light</option>
      <option value="dark">Dark</option>
    </select>

    <label for="setTemp">Temperature</label>
    <div class="settings-row">
      <input type="range" id="setTemp" min="0" max="2" step="0.1" value="0.7">
      <span class="range-val" id="setTempVal">0.7</span>
    </div>

    <label for="setWindow">Message Window (recent turns)</label>
    <div class="settings-row">
      <input type="range" id="setWindow" min="4" max="100" step="2" value="40">
      <span class="range-val" id="setWindowVal">40</span>
    </div>

    <label class="settings-check">
      <input type="checkbox" id="setRag" checked> Enable RAG (use truth entries)
    </label>

    <label class="settings-check">
      <input type="checkbox" id="setUrlFetch"> Allow URL fetching
    </label>

    <label class="settings-check">
      <input type="checkbox" id="setConfirm"> Confirm deletes and merges
    </label>

    <div class="settings-sep">
      <button class="btn btn-full" id="btnEditConfig">Edit config.yaml</button>
    </div>

    <div class="settings-actions">
      <button class="btn" id="btnSettingsCancel">Cancel</button>
      <button class="btn btn-primary" id="btnSettingsSave">Save</button>
    </div>
  </div>
</div>

<!-- Main area (tree + divider + chat) -->
<div class="main-area" id="mainArea">
  <!-- Tree view -->
  <div class="tree-container" id="treeContainer">
    <svg></svg>
  </div>

  <!-- Draggable divider -->
  <div class="resize-divider" id="resizeDivider"></div>

  <!-- Chat area -->
  <div class="chat-container" id="chatContainer">
    <div class="chat-wrapper" id="chatWrapper"></div>
  </div>
</div>

<!-- Input -->
<div class="input-bar">
  <div class="input-wrapper">
    <textarea id="msgInput" rows="1" placeholder="Message WikiOracle..." autofocus></textarea>
    <button class="send-btn" id="btnSend">Send</button>
  </div>
</div>

<!-- Hidden file input for import -->
<input type="file" id="fileImport" accept=".json,.jsonl" class="hidden">

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="util.js?v=2"></script>
<script src="d3tree.js?v=17"></script>
<script src="wikioracle.js?v=32"></script>
</body>
</html>
